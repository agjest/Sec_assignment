---
title: "sec_ass"
format: html
editor: visual
bibliography: Datasetthoyde-inntekt.bib
nocite: '@*'
---

```{r}
#| setup
#| echo: false
#| output: false
#| message: false
library(vtable)
library(tidyverse)
library(ggplot2)
library(tinytex)
library(ggpubr)
```

```{r}
hoyde <- modelr::heights
hoyde <- hoyde |>
  mutate(
    bmi = weight * 0.4536/(height * 2.54/100)^2,
    married = fct_collapse(
      .f = marital,
      married = "married",
      other_level = "not married"
      ),
    edu_fac = cut(
      x = education,
      breaks = c(0, 12, 14, 16, 21),
      labels = c("not_hs", "not_cc", "not_col", "col_plus"),
      right = FALSE
      )
    ) |>
  select(income:age, education:bmi, everything()) |>
  select(-education, -marital)
hoydeZeroInc <- hoyde |>
  filter(income == 0)
hoydeNormInc <- hoyde |>
  filter(income > 0 & income < 343830)
hoydeHighInc <- hoyde |>
  filter(income == 343830)
```

## Innledning

I denne oppgaven skal vi se på to ulike sammenhenger.
Sammenhengen mellom evnenivå og inntekt, og sammenhengen mellom ansiennitet og inntekt.

Vi bruker datasettet heights og deler datasettet opp i tre ulike fordelt på inntektsnivået.
Det første settet er for de med ingen inntekt.
Det andre settet er for normal inntekt der selve inntekten er mellom 0 og 343 830 amerikanske dollar.
Det siste settet er for de med inntekt fra 343 830 amerikanske doller og oppover.

Når vi sammeligner evnenivå og inntekt, bruker vi variabelen afqt.
Dette er en måleenhet som det amerikanske militæret bruker til å måle evnenivå.
@zotero-254

## Litteraturgjennomgang

Tidligere forskning peker på at for hvert ekstra IQ poeng, kan inntekten øke fra \$234 til \$616 per år @zagorsky2007

I sammenligningen mellom evnenivå og inntekt bruker vi variabelen afqt.

## Sammenheng mellom inntekt og evnenivå

```{r}
<<<<<<< HEAD
#sammenheng mellom afqt og inntekt i hoydeNormInc
hoydeNormInc |>
  ggplot(mapping = aes(x = afqt, y = income)) +
  geom_point() +
  geom_smooth()
```

I overstående plott ser vi en sammenheng mellom evnenivå og inntekt i datasettet hoydeNormInc.
Vi ser en stigning i den linjære linjen, noe som tilsier at økt envenivå gir høyere inntekt.

```{r}
#afqt i hoydeZeroInc og hoydeHighInc
ggplot(
  data = hoydeZeroInc
  )+
  geom_histogram(
    mapping = aes(x = afqt, y = after_stat(density)),
    alpha = 0.3,
    colour = "blue",
    fill = "blue")+
  geom_histogram(
    data = hoydeHighInc,
    mapping = aes(x = afqt, y = after_stat(density)),
    alpha = 0.5,
    colour = "red",
    fill = "red"
  )
```

I dette histogrammet ser vi på sammenhengen mellom evnenivået i to ulike datasett.
Datasettene som er brukt er hoydeZeroInc og hoydeHightInc.
Her ser vi at det er en klar differane i evnenivået i de ulike datasettene.
Datasettet med høy inntekt har helt klart hørere grad av envenivå sammenlignet med datasettet med ingen inntekt.

```{r}
#sammenheng mellom afqt og inntekt, facet mht. kjønn
ggplot(hoyde) +
  geom_point(
    mapping = aes(x = afqt, y = income)) +
  geom_smooth()
```

```{r}
#sammenheng mellom edu_fac/education og afqt
ggplot(
  data = hoyde,
  mapping = aes(
    x = edu_fac,
    y = afqt
  )
) +
  geom_point()
```

```{r}
#sammenheng mellom høyde og afqt
hoyde |>
  select(afqt, height) |>
  ggplot(mapping = aes(x = afqt, y = height)) +
  geom_point() +
  geom_smooth()
```

I dette plottet har vi sammenlighet evnenivå og høyde.
Vi kan se her at liten stigning i den linjære linjen.
Dette kan muligens forklares ved hjelp av det neste histogrammet.
I histogrammet sammenligner vi evnenivå på kvinner og menn.
Her ser vi at det er flest menn på høyt evnenivå.
Menn er også gjennomsnittlig høyere enn kvinner.

```{r}
# sammenligner afqt kvinner og menn på hele datasettet (ekstra) 
hoyde |>
  ggplot() +
  geom_histogram(
    data = filter(hoyde, sex == "male"),
    mapping = aes(x = afqt, y = after_stat(density)),
    alpha = 0.3,
    colour = "blue",
    fill = "blue"
  ) + 
  geom_histogram(
    data = filter(hoyde, sex == "female"),
    mapping = aes(x = afqt, y = after_stat(density)),
    alpha = 0.5,
    colour = "red",
    fill = "red"
  )
hoydeNormInc  |> 
  ggplot(
  mapping = aes(
    x = afqt,
    y = income
    )
  ) + 
  geom_jitter(
    size = 1,
    alpha = 0.40
    ) +
  geom_smooth(
    formula = y ~ x,
    method = "lm",
    colour = "black",
    lwd = 0.75,
    se = FALSE
    )
```

## Sammenheng mellom ansiennitet og inntekt

## Konklusjon

## Referanser
